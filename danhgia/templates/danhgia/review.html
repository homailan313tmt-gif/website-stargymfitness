{% extends "base-customer.html" %}
{% load static %}

{% block title %}ƒê√°nh gi√° | Star Gym Fitness{% endblock %}

{% block content %}

<!-- ====== PH·∫¶N TI√äU ƒê·ªÄ CH√çNH ====== -->
<div style="max-width:800px;margin:50px auto;color:white;text-align:center;">
  <!-- Ti√™u ƒë·ªÅ trang, cƒÉn gi·ªØa -->
  <h2 class="text-light mb-5" style="font-weight:600;">ƒê√°nh gi√°</h2>

  <!-- ====== FORM G·ª¨I ƒê√ÅNH GI√Å ====== -->
  <form method="post" class="text-light text-start mx-auto" style="max-width:500px;">
    {% csrf_token %} <!-- b·∫£o m·∫≠t CSRF b·∫Øt bu·ªôc trong Django -->

    <!-- H√†ng 1: ƒê√°nh gi√° chung -->
    <div class="mb-3 d-flex align-items-center justify-content-between">
      <label class="form-label mb-0">ƒê√°nh gi√° chung:</label>
      <div class="rating-group" id="rating-chung">
        {% for i in "12345" %} <!-- hi·ªÉn th·ªã 5 ng√¥i sao -->
        <span class="star" data-value="{{ i }}">‚òÖ</span>
        {% endfor %}
        <!-- input ·∫©n ƒë·ªÉ l∆∞u gi√° tr·ªã s·ªë sao (1-5) -->
        <input type="hidden" name="danh_gia_chung" id="input-chung" required>
      </div>
    </div>

    <!-- H√†ng 2: Th√°i ƒë·ªô ph·ª•c v·ª• -->
    <div class="mb-3 d-flex align-items-center justify-content-between">
      <label class="form-label mb-0">Th√°i ƒë·ªô ph·ª•c v·ª•:</label>
      <div class="rating-group" id="rating-phucvu">
        {% for i in "12345" %}
        <span class="star" data-value="{{ i }}">‚òÖ</span>
        {% endfor %}
        <input type="hidden" name="thai_do_phuc_vu" id="input-phucvu" required>
      </div>
    </div>

    <!-- H√†ng 3: Ch·∫•t l∆∞·ª£ng d·ªãch v·ª• -->
    <div class="mb-3 d-flex align-items-center justify-content-between">
      <label class="form-label mb-0">Ch·∫•t l∆∞·ª£ng d·ªãch v·ª•:</label>
      <div class="rating-group" id="rating-chatluong">
        {% for i in "12345" %}
        <span class="star" data-value="{{ i }}">‚òÖ</span>
        {% endfor %}
        <input type="hidden" name="chat_luong_dich_vu" id="input-chatluong" required>
      </div>
    </div>

    <!-- H√†ng 4: Nh·∫≠n x√©t chi ti·∫øt -->
    <div class="mb-4">
      <label class="form-label">Nh·∫≠n x√©t chi ti·∫øt:</label>
      <textarea name="nhan_xet" class="form-control bg-dark text-light" rows="4" placeholder="Th√™m nh·∫≠n x√©t"></textarea>
      {% if da_gui %}
        <p class="fst-italic mt-3"
           style="text-align:center; color:#FFD700; font-weight:100;">
           ƒê√°nh gi√° th√†nh c√¥ng!</p>
      {% endif %}
    </div>

    <!-- N√∫t G·ª¨I & H·ª¶Y -->
    <div class="d-flex justify-content-center gap-3 mt-3">
      <button type="submit" class="btn btn-warning px-4">G·ª≠i</button>
      <a href="{% url 'theo_doi' %}" class="btn btn-secondary px-4">H·ªßy</a>
    </div>
  </form>
</div>

<!-- ====== PH·∫¶N HI·ªÇN TH·ªä C√ÅC ƒê√ÅNH GI√Å G·∫¶N ƒê√ÇY ====== -->
<hr class="my-5 text-secondary">

<h4 class="text-warning text-center mb-3">ƒê√°nh gi√° g·∫ßn ƒë√¢y</h4>
<div class="text-light">
  {% for dg in danhgias %}
    <!-- m·ªói ƒë√°nh gi√° hi·ªÉn th·ªã sao, nh·∫≠n x√©t v√† th·ªùi gian -->
    <div class="border-bottom border-secondary py-2">
      <p>‚≠ê {{ dg.danh_gia_chung }}/5 | üí¨ {{ dg.nhan_xet }}</p>
      <small class="text-secondary">{{ dg.ngay_tao|date:"d/m/Y H:i" }}</small>
    </div>
  {% empty %}
    <!-- n·∫øu ch∆∞a c√≥ ƒë√°nh gi√° -->
    <p class="text-center text-secondary">Ch∆∞a c√≥ ƒë√°nh gi√° n√†o.</p>
  {% endfor %}
</div>


<!-- ====== CSS: CƒÇN GIAO DI·ªÜN & STYLE NG√îI SAO ====== -->
<style>
.col-form-label {
  font-size: 1rem;
  font-weight: 500;
  color: #f5f5f5;
}

/* cƒÉn h√†ng ng√¥i sao ngang h√†ng label */
.rating-group {
  display: flex;
  gap: 5px;
  flex-direction: row;
}

/* style sao */
.star {
  font-size: 36px;
  color: #555;
  cursor: pointer;
  transition: color 0.25s ease;
}

/* khi ch·ªçn sao th√¨ chuy·ªÉn v√†ng */
.star.active {
  color: gold;
}

/* hover v√†ng t·∫°m th·ªùi */
.star:hover {
  color: gold;
    transform: scale(1.2);
}

.form-label {
 font-size: 1.1rem;
  width: 200px;             /* r·ªông h∆°n ƒë·ªÉ c√¢n b·ªë c·ª•c */
  text-align: left;
  font-size: 1.1rem;        /* tƒÉng k√≠ch th∆∞·ªõc ch·ªØ (~18px) */
  font-weight: 200;         /* ch·ªØ ƒë·∫≠m h∆°n */
  color: #f8f8f8;           /* tr·∫Øng s√°ng h∆°n nh·∫π */
  letter-spacing: 0.3px;    /* gi√£n nh·∫π cho d·ªÖ ƒë·ªçc */
}

form {
  margin-top: -30px; /* k√©o form l√™n g·∫ßn ti√™u ƒë·ªÅ h∆°n */
}

.mb-3 {
  margin-bottom: 15px !important; /* gi·∫£m kho·∫£ng c√°ch gi·ªØa c√°c h√†ng */
}
.mb-4 {
  margin-top: 25px !important;
  margin-bottom: 15px !important; /* cho ƒë·ªìng ƒë·ªÅu v·ªõi 3 d√≤ng tr√™n */
}
textarea {
  margin-top: 10px; /* ƒë·ªÉ textarea kh√¥ng d√≠nh s√°t label */
}


</style>


<!-- ====== JS: X·ª¨ L√ù CLICK CH·ªåN SAO ====== -->
<script>
document.addEventListener("DOMContentLoaded", function() {
  // h√†m d√πng chung cho 3 nh√≥m sao
  function setupRating(groupId, inputId) {
    const stars = document.querySelectorAll(`#${groupId} .star`);
    const input = document.getElementById(inputId);

    // x·ª≠ l√Ω khi ng∆∞·ªùi d√πng click ch·ªçn sao
    stars.forEach((star, index) => {
      star.addEventListener("click", () => {
        input.value = star.dataset.value; // g√°n gi√° tr·ªã sao v√†o input ·∫©n
        // t√¥ v√†ng c√°c sao ƒë√£ ch·ªçn
        stars.forEach((s, i) => {
          s.classList.toggle("active", i <= index);
        });
      });
    });
  }

  // g·ªçi h√†m cho 3 nh√≥m sao
  setupRating("rating-chung", "input-chung");
  setupRating("rating-phucvu", "input-phucvu");
  setupRating("rating-chatluong", "input-chatluong");
});
</script>

{% endblock %}
